<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daftar Antrian Modern</title>
  <style>
    /* Fikirkan ide baru untuk kemajuan tampilannya */
    :root {
      --bg: #f0f2f5;
      --card-bg: #ffffff;
      --text-primary: #1f2937;
      --text-secondary: #4b5563;
      --border: #e5e7eb;
      --accent-success: #10b981;
      --accent-pending: #f59e0b;
      --accent-failed:  #ef4444;
      --accent-cancel:  #6b7280;
      --scrollbar-bg: #d1d5db;
      --scrollbar-thumb: #9ca3af;
      --transition: 0.3s ease;
      --radius: 8px;
      --font: -apple-system, BlinkMacSystemFont, “Segoe UI”, Roboto, “Inter”, sans-serif;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #181a1f;
        --card-bg: #1f2228;
        --text-primary: #e5e7eb;
        --text-secondary: #9ca3af;
        --border: #2f3136;
        --scrollbar-bg: #3a3c42;
        --scrollbar-thumb: #4b5563;
      }
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: var(--font);
      background: var(--bg);
      color: var(--text-primary);
      min-height: 100vh;
      position: relative;
    }
    header {
      position: sticky; top: 0; z-index: 1000;
      background: var(--card-bg); border-bottom: 1px solid var(--border);
      padding: 1rem; display: flex; align-items: center; gap: 1rem;
    }
    .search {
      flex: 1; position: relative;
    }
    .search input {
      width: 100%; padding: 0.75rem 1rem 0.75rem 2.5rem;
      border: 1px solid var(--border); border-radius: var(--radius);
      transition: border var(--transition);
      background: var(--card-bg);
      color: var(--text-primary);
    }
    .search input:focus { border-color: var(--accent-pending); outline: none; }
    .search svg {
      position: absolute; left: 0.75rem; top: 50%;
      width: 1rem; height: 1rem; transform: translateY(-50%);
      fill: var(--text-secondary);
    }
    #list { padding: 1rem; max-width: 800px; margin: auto; }
    .card {
      background: var(--card-bg); border: 1px solid var(--border);
      border-radius: var(--radius); margin-bottom: 0.75rem;
      overflow: hidden; transition: transform var(--transition), box-shadow var(--transition);
    }
    .card:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    .summary {
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.75rem 1rem; cursor: pointer;
    }
    .summary-left { display: flex; align-items: center; gap: 1rem; }
    .badge {
      padding: 0.25rem 0.5rem; border-radius: 12px;
      font-size: 0.75rem; font-weight: 600; color: #fff;
    }
    .badge.success { background: var(--accent-success); }
    .badge.pending { background: var(--accent-pending); }
    .badge.failed  { background: var(--accent-failed); }
    .badge.cancel  { background: var(--accent-cancel); }
    .arrow {
      width: 1rem; height: 1rem; transition: transform var(--transition);
      fill: var(--text-secondary);
    }
    .card.open .arrow { transform: rotate(180deg); }
    .details {
      max-height: 0; overflow: hidden;
      transition: max-height var(--transition), padding var(--transition);
      padding: 0 1rem;
      border-top: 1px solid var(--border);
    }
    .card.open .details {
      padding: 0.75rem 1rem; max-height: 500px;
    }
    .details p {
      font-size: 0.875rem; color: var(--text-secondary);
      margin-bottom: 0.5rem; display: flex; gap: 0.5rem;
    }
    .details strong { width: 80px; flex-shrink: 0; color: var(--text-primary); }
    /* Back to top */
    #topBtn {
      position: fixed; bottom: 2rem; right: 2rem; display: none;
      background: var(--accent-pending); border: none; padding: 0.75rem;
      border-radius: 50%; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: opacity var(--transition);
    }
    #topBtn.show { display: block; }
    #topBtn svg { width: 1rem; height: 1rem; fill: #fff; }
    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: var(--scrollbar-bg); }
    ::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 4px; }
  </style>
</head>
<body>

<header>
  <div class="search">
    <svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27..."/></svg>
    <input type="text" id="searchInput" placeholder="Cari Nomor, Nama, Produk...">
  </div>
</header>

<main id="list"></main>

<button id="topBtn" title="Kembali ke Atas">
  <svg viewBox="0 0 24 24"><path d="M4 12l1.41 1.41L11 7.83v12.34h2V7.83l5.59 5.58L20 12l-8-8-8 8z"/></svg>
</button>

<script>
  let data = [];       // seluruh data antrian
  let batchSize = 50;  // jumlah per render
  let offset = 0;
  let filtered = [];
  const listEl = document.getElementById('list');
  const searchEl = document.getElementById('searchInput');
  const topBtn = document.getElementById('topBtn');

  // simulasi load data
  async function loadData() {
    // ganti dengan fetch CSV/JSON asli
    const res = await fetch('data.json');
    data = await res.json();
    filtered = data;
    renderBatch();
  }

  function renderBatch() {
    const slice = filtered.slice(offset, offset + batchSize);
    slice.forEach(item => listEl.appendChild(createCard(item)));
    offset += batchSize;
  }

  function createCard(item) {
    const card = document.createElement('div');
    card.className = 'card';
    // summary
    const sum = document.createElement('div');
    sum.className = 'summary';
    const left = document.createElement('div');
    left.className = 'summary-left';
    left.innerHTML = `<strong>#${item.nomor}</strong>
                      <span>${item.nickname}</span>
                      <span>${item.produk}</span>`;
    const badge = document.createElement('span');
    badge.className = `badge ${item.status.toLowerCase()}`;
    badge.textContent = item.status;
    const arrow = document.createElementNS('http://www.w3.org/2000/svg','svg');
    arrow.setAttribute('viewBox','0 0 24 24');
    arrow.classList.add('arrow');
    arrow.innerHTML = '<path d="M7.41 8.59L12 13.17l4.59-4.58..."/>';
    sum.append(left, badge, arrow);
    // details
    const det = document.createElement('div');
    det.className = 'details';
    const content = document.createElement('div');
    content.innerHTML = Object.entries(item).map(([k,v]) =>
      k!=='nomor'&&k!=='nickname'&&k!=='produk'&&`<p><strong>${k}:</strong>${v}</p>`
    ).join('');
    det.append(content);
    card.append(sum, det);
    sum.addEventListener('click', () => {
      const open = card.classList.toggle('open');
      if (open) det.style.maxHeight = det.scrollHeight + 'px';
      else det.style.maxHeight = null;
    });
    return card;
  }

  // infinite scroll
  window.addEventListener('scroll', () => {
    if (window.innerHeight + window.pageYOffset >= document.body.offsetHeight - 300) {
      if (offset < filtered.length) renderBatch();
    }
    topBtn.classList.toggle('show', window.pageYOffset > 400);
  });

  // back to top
  topBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

  // search & reset
  searchEl.addEventListener('input', () => {
    const q = searchEl.value.toLowerCase();
    filtered = data.filter(x =>
      x.nomor.includes(q) || x.nickname.toLowerCase().includes(q) || x.produk.toLowerCase().includes(q)
    );
    offset = 0; listEl.innerHTML = '';
    renderBatch();
  });

  loadData();
</script>

</body>
</html>
