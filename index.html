<!DOCTYPE html>

<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Antrian Pre Order</title>
  <style>
    :root {
      --bg-primary: #fbfbfd;
      --bg-secondary: #f5f5f7;
      --bg-tertiary: #ffffff;
      --bg-dark-primary: #000000;
      --bg-dark-secondary: #1d1d1f;
      --bg-dark-tertiary: #2c2c2e;
      --text-primary: #1d1d1f;
      --text-secondary: #86868b;
      --text-tertiary: #515154;
      --text-dark-primary: #f2f2f7;
      --text-dark-secondary: #98989d;
      --text-dark-tertiary: #86868b;
      --accent-blue: #007aff;
      --accent-green: #30d158;
      --accent-orange: #ff9f0a;
      --accent-red: #ff453a;
      --accent-gray: #8e8e93;
      --radius-small: 8px;
      --radius-medium: 12px;
      --radius-large: 16px;
      --radius-xl: 20px;
      --shadow-small: 0 1px 3px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.06);
      --shadow-medium: 0 4px 6px rgba(0,0,0,0.03), 0 2px 4px rgba(0,0,0,0.06);
      --shadow-large: 0 20px 25px rgba(0,0,0,0.05), 0 8px 10px rgba(0,0,0,0.04);
      --shadow-xl: 0 25px 50px rgba(0,0,0,0.08), 0 0 0 1px rgba(255,255,255,0.05);
      --blur: blur(20px);
      --font-system: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Icons", "Helvetica Neue", Helvetica, Arial, sans-serif;
      --transition-fast: all 0.15s cubic-bezier(0.4, 0.0, 0.2, 1);
      --transition-medium: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
      --transition-slow: all 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
    }

```
* {
  box-sizing: border-box;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  margin: 0;
  padding: 0;
  font-family: var(--font-system);
  background: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.6;
  font-size: 17px;
  font-weight: 400;
  transition: var(--transition-medium);
  overflow-x: hidden;
}

body.dark {
  background: var(--bg-dark-primary);
  color: var(--text-dark-primary);
}

.container {
  max-width: 1200px;
  margin: 0 auto;
  padding: 32px 20px;
  display: flex;
  flex-direction: column;
  gap: 40px;
  min-height: 100vh;
}

/* Header with glassmorphism */
.header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(251, 251, 253, 0.8);
  backdrop-filter: var(--blur);
  -webkit-backdrop-filter: var(--blur);
  border-bottom: 0.5px solid rgba(0,0,0,0.04);
  margin: -32px -20px 40px -20px;
  padding: 24px 20px;
  transition: var(--transition-medium);
}

body.dark .header {
  background: rgba(0, 0, 0, 0.8);
  border-bottom: 0.5px solid rgba(255,255,255,0.1);
}

.header-content {
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.title {
  font-size: 32px;
  font-weight: 700;
  letter-spacing: -0.5px;
  margin: 0;
  background: linear-gradient(135deg, var(--text-primary), var(--text-tertiary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

body.dark .title {
  background: linear-gradient(135deg, var(--text-dark-primary), var(--text-dark-secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.theme-toggle {
  position: relative;
  width: 56px;
  height: 32px;
  background: var(--bg-secondary);
  border: none;
  border-radius: 16px;
  cursor: pointer;
  transition: var(--transition-medium);
  display: flex;
  align-items: center;
  padding: 2px;
  overflow: hidden;
}

body.dark .theme-toggle {
  background: var(--bg-dark-secondary);
}

.theme-toggle::before {
  content: '';
  position: absolute;
  width: 28px;
  height: 28px;
  background: var(--bg-tertiary);
  border-radius: 50%;
  transition: var(--transition-medium);
  transform: translateX(0);
  box-shadow: var(--shadow-small);
}

body.dark .theme-toggle::before {
  background: var(--bg-dark-tertiary);
  transform: translateX(24px);
}

.theme-toggle:hover {
  transform: scale(1.05);
}

/* Controls with improved spacing */
.controls {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr;
  gap: 20px;
  margin-bottom: 8px;
}

@media (max-width: 768px) {
  .controls {
    grid-template-columns: 1fr;
    gap: 16px;
  }
}

.input-group {
  position: relative;
}

.search-input, .filter-select {
  width: 100%;
  padding: 16px 20px;
  font-size: 17px;
  font-weight: 400;
  background: var(--bg-tertiary);
  border: 0.5px solid rgba(0,0,0,0.04);
  border-radius: var(--radius-medium);
  color: var(--text-primary);
  transition: var(--transition-medium);
  appearance: none;
  outline: none;
}

body.dark .search-input,
body.dark .filter-select {
  background: var(--bg-dark-tertiary);
  border-color: rgba(255,255,255,0.1);
  color: var(--text-dark-primary);
}

.search-input:focus,
.filter-select:focus {
  border-color: var(--accent-blue);
  box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.1);
  transform: translateY(-1px);
}

.search-input::placeholder {
  color: var(--text-secondary);
  font-weight: 400;
}

body.dark .search-input::placeholder {
  color: var(--text-dark-secondary);
}

/* Card system with premium styling */
.card-grid {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.card {
  background: var(--bg-tertiary);
  border: 0.5px solid rgba(0,0,0,0.04);
  border-radius: var(--radius-large);
  padding: 24px;
  cursor: pointer;
  transition: var(--transition-medium);
  position: relative;
  overflow: hidden;
}

body.dark .card {
  background: var(--bg-dark-tertiary);
  border-color: rgba(255,255,255,0.1);
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, transparent, rgba(255,255,255,0.02));
  opacity: 0;
  transition: var(--transition-medium);
  pointer-events: none;
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-large);
  border-color: rgba(0,0,0,0.08);
}

body.dark .card:hover {
  border-color: rgba(255,255,255,0.2);
}

.card:hover::before {
  opacity: 1;
}

.card-header {
  display: grid;
  grid-template-columns: auto 1fr auto auto;
  gap: 16px;
  align-items: center;
  margin-bottom: 0;
}

.card-number {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-secondary);
  background: var(--bg-secondary);
  padding: 6px 12px;
  border-radius: var(--radius-small);
  min-width: 48px;
  text-align: center;
}

body.dark .card-number {
  color: var(--text-dark-secondary);
  background: var(--bg-dark-secondary);
}

.card-name {
  font-size: 19px;
  font-weight: 600;
  color: var(--text-primary);
  letter-spacing: -0.2px;
}

body.dark .card-name {
  color: var(--text-dark-primary);
}

.card-product {
  font-size: 15px;
  font-weight: 500;
  color: var(--text-tertiary);
}

body.dark .card-product {
  color: var(--text-dark-tertiary);
}

/* Premium status badges */
.status-badge {
  position: relative;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 600;
  letter-spacing: 0.2px;
  text-transform: uppercase;
  border: none;
  cursor: default;
  transition: var(--transition-medium);
}

.status-badge.success {
  background: rgba(48, 209, 88, 0.1);
  color: var(--accent-green);
  border: 0.5px solid rgba(48, 209, 88, 0.2);
}

.status-badge.pending {
  background: rgba(255, 159, 10, 0.1);
  color: var(--accent-orange);
  border: 0.5px solid rgba(255, 159, 10, 0.2);
}

.status-badge.failed {
  background: rgba(255, 69, 58, 0.1);
  color: var(--accent-red);
  border: 0.5px solid rgba(255, 69, 58, 0.2);
}

.status-badge.canceled {
  background: rgba(142, 142, 147, 0.1);
  color: var(--accent-gray);
  border: 0.5px solid rgba(142, 142, 147, 0.2);
}

/* Expandable details with smooth animation */
.card-details {
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transition: all 0.4s cubic-bezier(0.4, 0.0, 0.2, 1);
  margin-top: 0;
}

.card.expanded .card-details {
  max-height: 1000px;
  opacity: 1;
  margin-top: 24px;
  padding-top: 24px;
  border-top: 0.5px solid rgba(0,0,0,0.06);
}

body.dark .card.expanded .card-details {
  border-top-color: rgba(255,255,255,0.1);
}

.details-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

.detail-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.detail-label {
  font-size: 13px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

body.dark .detail-label {
  color: var(--text-dark-secondary);
}

.detail-value {
  font-size: 16px;
  font-weight: 500;
  color: var(--text-primary);
}

body.dark .detail-value {
  color: var(--text-dark-primary);
}

/* Premium pagination */
.pagination {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-top: 48px;
}

.pagination-btn {
  padding: 12px 24px;
  background: var(--bg-tertiary);
  border: 0.5px solid rgba(0,0,0,0.04);
  border-radius: var(--radius-medium);
  font-size: 16px;
  font-weight: 500;
  color: var(--text-primary);
  cursor: pointer;
  transition: var(--transition-medium);
  min-width: 120px;
}

body.dark .pagination-btn {
  background: var(--bg-dark-tertiary);
  border-color: rgba(255,255,255,0.1);
  color: var(--text-dark-primary);
}

.pagination-btn:hover:not(:disabled) {
  background: var(--accent-blue);
  color: white;
  transform: translateY(-1px);
  box-shadow: var(--shadow-medium);
}

.pagination-btn:disabled {
  opacity: 0.3;
  cursor: not-allowed;
  transform: none;
}

/* Floating scroll to top */
.scroll-top {
  position: fixed;
  right: 24px;
  bottom: 24px;
  width: 56px;
  height: 56px;
  background: rgba(0, 122, 255, 0.9);
  backdrop-filter: var(--blur);
  -webkit-backdrop-filter: var(--blur);
  border: none;
  border-radius: 50%;
  color: white;
  font-size: 24px;
  cursor: pointer;
  transform: translateY(100px);
  opacity: 0;
  transition: var(--transition-medium);
  box-shadow: var(--shadow-large);
  z-index: 1000;
}

.scroll-top.show {
  transform: translateY(0);
  opacity: 1;
}

.scroll-top:hover {
  transform: scale(1.1);
  background: var(--accent-blue);
}

/* Loading state */
.loading {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 80px 20px;
  flex-direction: column;
  gap: 20px;
}

.spinner {
  width: 32px;
  height: 32px;
  border: 2px solid var(--bg-secondary);
  border-top: 2px solid var(--accent-blue);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

body.dark .spinner {
  border-color: var(--bg-dark-secondary);
  border-top-color: var(--accent-blue);
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.empty-state {
  text-align: center;
  padding: 80px 20px;
  color: var(--text-secondary);
}

body.dark .empty-state {
  color: var(--text-dark-secondary);
}

.empty-state-icon {
  font-size: 64px;
  margin-bottom: 16px;
  opacity: 0.3;
}

.empty-state-text {
  font-size: 19px;
  font-weight: 500;
  margin-bottom: 8px;
}

.empty-state-subtext {
  font-size: 15px;
  opacity: 0.7;
}

/* Micro animations */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.card {
  animation: fadeInUp 0.5s ease-out forwards;
}

.card:nth-child(2) { animation-delay: 0.1s; }
.card:nth-child(3) { animation-delay: 0.2s; }
.card:nth-child(4) { animation-delay: 0.3s; }
.card:nth-child(5) { animation-delay: 0.4s; }

/* Responsive improvements */
@media (max-width: 768px) {
  .container {
    padding: 20px 16px;
    gap: 24px;
  }

  .header {
    margin: -20px -16px 24px -16px;
    padding: 16px;
  }

  .title {
    font-size: 24px;
  }

  .card {
    padding: 20px;
  }

  .card-header {
    grid-template-columns: 1fr;
    gap: 12px;
    text-align: center;
  }

  .details-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }

  .scroll-top {
    right: 16px;
    bottom: 16px;
    width: 48px;
    height: 48px;
    font-size: 20px;
  }
}
```

  </style>
</head>
<body>
  <div class="header">
    <div class="header-content">
      <h1 class="title">Antrian Pre Order</h1>
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode"></button>
    </div>
  </div>

  <div class="container">
    <section class="controls">
      <div class="input-group">
        <input type="search" class="search-input" id="search" placeholder="Cari nomor telepon atau nickname..." />
      </div>
      <div class="input-group">
        <select class="filter-select" id="statusFilter">
          <option value="all">Semua Status</option>
          <option value="success">Success</option>
          <option value="pending">Pending</option>
          <option value="failed">Failed</option>
          <option value="canceled">Batal</option>
        </select>
      </div>
      <div class="input-group">
        <select class="filter-select" id="sheetFilter">
          <option value="0">Gift Starlight</option>
          <option value="1">PO Event Misi</option>
          <option value="2">Pre Order Skin</option>
          <option value="3">Pre Order Joki</option>
        </select>
      </div>
    </section>

```
<main class="card-grid" id="listContainer">
  <div class="loading">
    <div class="spinner"></div>
    <p>Memuat data...</p>
  </div>
</main>

<nav class="pagination">
  <button class="pagination-btn" id="prevPage">Sebelumnya</button>
  <button class="pagination-btn" id="nextPage">Selanjutnya</button>
</nav>
```

  </div>

<button class="scroll-top" id="scrollTopBtn">↑</button>

  <script>
    (() => {
      const body = document.body;
      const themeToggle = document.getElementById('themeToggle');
      const searchInput = document.getElementById('search');
      const statusFilter = document.getElementById('statusFilter');
      const sheetFilter = document.getElementById('sheetFilter');
      const listContainer = document.getElementById('listContainer');
      const prevPageBtn = document.getElementById('prevPage');
      const nextPageBtn = document.getElementById('nextPage');
      const scrollTopBtn = document.getElementById('scrollTopBtn');

      let allData = [];
      let currentPage = 1;
      const itemsPerPage = 20;

      // Theme management
      function saveTheme(theme) {
        localStorage.setItem('theme', theme);
      }
      
      function loadTheme() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          body.classList.add('dark');
        }
      }
      
      function toggleTheme() {
        body.classList.toggle('dark');
        saveTheme(body.classList.contains('dark') ? 'dark' : 'light');
      }

      // Data fetching
      function fetchSheet(sheetIndex = 0) {
        listContainer.innerHTML = `
          <div class="loading">
            <div class="spinner"></div>
            <p>Memuat data...</p>
          </div>
        `;
        
        const url = `https://docs.google.com/spreadsheets/d/1B0XPR4uSvRzy9LfzWDjNjwAyMZVtJs6_Kk_r2fh7dTw/gviz/tq?tqx=out:csv&sheet=Sheet${sheetIndex+1}`;
        
        fetch(url)
          .then(res => {
            if (!res.ok) throw new Error(res.statusText);
            return res.text();
          })
          .then(text => {
            const rows = text.trim().split('\n').map(r => 
              r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => 
                c.replace(/^"|"$/g, '').trim()
              )
            );
            const headers = rows.shift();
            allData = rows.map(row => {
              let obj = {};
              row.forEach((v, i) => {
                obj[headers[i]] = headers[i] && headers[i].toLowerCase().includes('status') ? v.toLowerCase() : v;
              });
              return obj;
            });
            currentPage = 1;
            renderList();
          })
          .catch(() => {
            listContainer.innerHTML = `
              <div class="empty-state">
                <div class="empty-state-icon">⚠️</div>
                <div class="empty-state-text">Gagal memuat data</div>
                <div class="empty-state-subtext">Pastikan Google Sheet dapat diakses publik</div>
              </div>
            `;
          });
      }

      // Data filtering
      function filterData() {
        const q = searchInput.value.toLowerCase();
        const status = statusFilter.value;

        return allData.filter(item => {
          const phone = (item['Nomor Telepon'] || item['No Telepon'] || '').toLowerCase();
          const name = (item['Nickname'] || item['Nama Pemesan'] || item['Nama'] || '').toLowerCase();
          const itemStatus = (item['Status'] || '').toLowerCase();

          const matchesSearch = phone.includes(q) || name.includes(q);
          const matchesStatus = status === 'all' || itemStatus === status;

          return matchesSearch && matchesStatus;
        });
      }

      // List rendering
      function renderList() {
        const filtered = filterData();
        const totalPages = Math.ceil(filtered.length / itemsPerPage);
        if(currentPage > totalPages) currentPage = totalPages || 1;

        const start = (currentPage - 1) * itemsPerPage;
        const pageData = filtered.slice(start, start + itemsPerPage);

        listContainer.innerHTML = '';
        
        if(pageData.length === 0) {
          listContainer.innerHTML = `
            <div class="empty-state">
              <div class="empty-state-icon">🔍</div>
              <div class="empty-state-text">Tidak ada data yang cocok</div>
              <div class="empty-state-subtext">Coba ubah filter atau kata kunci pencarian</div>
            </div>
          `;
          prevPageBtn.disabled = true;
          nextPageBtn.disabled = true;
          return;
        }

        pageData.forEach((item, index) => {
          const statusClass = {
            success: 'success',
            pending: 'pending',
            failed: 'failed',
            canceled: 'canceled'
          }[item['Status']] || 'canceled';

          const card = document.createElement('article');
          card.className = 'card';
          card.style.animationDelay = `${index * 0.1}s`;

          const detailsHtml = Object.entries(item)
            .filter(([k]) => !['Nomor','Nomor Telepon','No Telepon','Nickname','Nama Pemesan','Nama','Produk','Status'].includes(k))
            .map(([k, v]) => `
              <div class="detail-item">
                <div class="detail-label">${k}</div>
                <div class="detail-value">${v || 'N/A'}</div>
              </div>
            `).join('');

          card.innerHTML = `
            <div class="card-header">
              <div class="card-number">#${item['Nomor'] || 'N/A'}</div>
              <div class="card-name">${item['Nickname'] || item['Nama Pemesan'] || item['Nama'] || 'Tanpa Nickname'}</div>
              <div class="card-product">${item['Produk'] || 'N/A'}</div>
              <div class="status-badge ${statusClass}">${item['Status']?.toUpperCase() || 'BATAL'}</div>
            </div>
            <div class="card-details">
              <div class="details-grid">
                ${detailsHtml}
              </div>
            </div>
          `;

          card.addEventListener('click', () => {
            card.classList.toggle('expanded');
          });

          listContainer.appendChild(card);
        });

        prevPageBtn.disabled = currentPage <= 1;
        nextPageBtn.disabled = currentPage >= totalPages;
      }

      // Pagination
      function changePage(offset) {
        currentPage += offset;
        renderList();
        window.scrollTo({top: 0, behavior: 'smooth'});
      }

      // Scroll management
      function handleScroll() {
        scrollTopBtn.classList.toggle('show', window.scrollY > 400);
      }

      // Event listeners
      themeToggle.addEventListener('click', toggleTheme);
      searchInput.addEventListener('input', () => { 
        currentPage = 1; 
        renderList(); 
      });
      statusFilter.addEventListener('change', () => { 
        currentPage = 1; 
        renderList(); 
      });
      sheetFilter.addEventListener('change', () => { 
        fetchSheet(Number(sheetFilter.value)); 
      });
      prevPageBtn.addEventListener('click', () => changePage(-1));
      nextPageBtn.addEventListener('click', () => changePage(1));
      window.addEventListener('scroll', handleScroll);
      scrollTopBtn.addEventListener('click', () => 
        window.scrollTo({top: 0, behavior: 'smooth'})
      );

      // Initialize
      loadTheme();
      fetchSheet(0);
      handleScroll();
    })();
  </script>

</body>
</html>
